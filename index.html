<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sano Bld</title>
    
    <link rel="icon" type="image/png" href="logo.png?v=2">

    <link rel="stylesheet" href="style.css">
</head>
<body>

    <canvas id="particle-canvas"></canvas>
    <div id="cursor-dot"></div>

    <div class="container">
        <div class="top-controls">
            <button id="accent-toggle" class="ctrl-btn active-fx">TRANSP</button>
            <button id="theme-toggle" class="ctrl-btn active-fx">MODE</button>
        </div>

        <div id="main-content" style="width:100%; display:flex; flex-direction:column; align-items:center;">
            <div class="logo-wrapper">
                <img src="logo.png" alt="Logo" class="main-logo">
            </div>
            
            <h1 id="main-title">SANO BLD</h1>
            <div class="status">// SYSTÈME CONNECTÉ</div>
            
            <div class="widgets-row">
                <div class="widget active-fx" id="date-widget">
                    <span id="date-val" class="dyn-txt" style="font-size:1.1rem;">--.--.--</span>
                    <span id="date-label" style="font-size:0.6rem; color:inherit; margin-top:4px; text-transform:uppercase;">Calendrier</span>
                </div>
                <div class="widget active-fx" id="view-widget">
                    <span id="view-val" class="dyn-txt" style="font-size:1.1rem;">...</span>
                    <span id="view-label" style="font-size:0.6rem; color:inherit; margin-top:4px; text-transform:uppercase;">Vues</span>
                </div>
            </div>

            <nav class="links-grid">
                <a href="https://soboheme.github.io/Web/" target="_blank" class="link-item active-fx"><span>// SOBOHÈME</span><span>→</span></a>
                <a href="https://www.instagram.com/bldnoham/" target="_blank" class="link-item active-fx"><span>// INSTAGRAM</span><span>→</span></a>
                <a href="https://www.tiktok.com/@nohambld" target="_blank" class="link-item active-fx"><span>// TIKTOK</span><span>→</span></a>
                <a href="https://x.com/SanoBld" target="_blank" class="link-item active-fx"><span>// TWITTER</span><span>→</span></a>
                <a href="https://www.reddit.com/user/Sano_bld/" target="_blank" class="link-item active-fx"><span>// REDDIT</span><span>→</span></a>
                <a href="https://discord.gg/nothingtech" target="_blank" class="link-item active-fx"><span>// DISCORD NOTHING</span><span>→</span></a>
                <a href="https://github.com/SanoBld" target="_blank" class="link-item active-fx"><span>// GITHUB</span><span>→</span></a>

                <div class="about-section active-fx" id="about-trigger">
                    <div class="about-header">
                        <span>// À PROPOS</span>
                        <span class="arrow-icon">→</span>
                    </div>
                    <div class="about-content-wrapper">
                        <p style="font-size:1rem; line-height:1.4; color:inherit; margin:0;">
                            Première interface personnelle conçue comme une exploration du développement web. Ce projet combine une esthétique brute inspirée de <span class="dyn-txt">Nothing</span>.
                        </p>
                    </div>
                </div>
            </nav>

            <footer class="footer">SANO BLD // 2025</footer>
        </div>
    </div>

    <script>
        const body = document.body;
        const themeBtn = document.getElementById('theme-toggle');
        const accentBtn = document.getElementById('accent-toggle');

        const colors = [
            { name: 'TRANSP', main: '#ff0037', border: 'rgba(255, 255, 255, 0.1)', dyn: 'inherit', rev: 'auto' },
            { name: 'ROUGE',  main: '#ff0037', border: 'rgba(255, 0, 55, 0.4)',  dyn: '#ff0037', rev: '#ff0037' }, 
            { name: 'BLANC',  main: '#ffffff', border: 'rgba(255, 255, 255, 0.4)', dyn: '#ffffff', rev: '#ffffff' }, 
            { name: 'NOIR',   main: '#000000', border: 'rgba(0, 0, 0, 0.4)',      dyn: '#444',    rev: '#000000' },      
            { name: 'JAUNE',  main: '#f5d94a', border: 'rgba(245, 217, 74, 0.5)', dyn: '#f5d94a', rev: '#f5d94a' }
        ];
        let currentColorIdx = 0;

        function updateRevealColor() {
            const theme = colors[currentColorIdx];
            if (theme.rev === 'auto') {
                const isLight = body.classList.contains('light-mode');
                document.documentElement.style.setProperty('--reveal-color', isLight ? '#000000' : '#ffffff');
            } else {
                document.documentElement.style.setProperty('--reveal-color', theme.rev);
            }
        }

        accentBtn.onclick = () => {
            currentColorIdx = (currentColorIdx + 1) % colors.length;
            const theme = colors[currentColorIdx];
            accentBtn.textContent = theme.name;
            document.documentElement.style.setProperty('--accent-color', theme.main);
            document.documentElement.style.setProperty('--card-border', theme.border);
            document.documentElement.style.setProperty('--dynamic-color', theme.dyn);
            updateRevealColor();
            playTick();
        };

        const themeMediaQuery = window.matchMedia('(prefers-color-scheme: light)');
        body.classList.toggle('light-mode', themeMediaQuery.matches);
        
        themeBtn.onclick = () => { 
            body.classList.toggle('light-mode'); 
            themeBtn.textContent = body.classList.contains('light-mode') ? "SOMBRE" : "CLAIR"; 
            updateRevealColor(); 
            playTick(); 
        };

        let showTime = false;
        function renderDate() {
            const now = new Date();
            const dateVal = document.getElementById('date-val');
            if (showTime) dateVal.textContent = now.toLocaleTimeString('fr-FR', {hour:'2-digit', minute:'2-digit', second:'2-digit'});
            else dateVal.textContent = `${String(now.getDate()).padStart(2, '0')}.${String(now.getMonth() + 1).padStart(2, '0')}.${now.getFullYear().toString().slice(-2)}`;
        }
        setInterval(() => { if(showTime) renderDate(); }, 1000); 
        renderDate();
        document.getElementById('date-widget').onclick = () => { showTime = !showTime; renderDate(); playTick(); };

        const viewVal = document.getElementById('view-val');
        const viewLabel = document.getElementById('view-label');
        let infoState = 0;
        let v = "...";

        async function fetchGlobalViews() {
            try {
                const res = await fetch('https://api.lyket.dev/v1/like-buttons/sano_bld_live_counter_v3/press', {
                    method: 'POST',
                    headers: { 'Authorization': 'Bearer pt-21e3c8340d877e841f3801f95a4392' }
                });
                const data = await res.json();
                v = data.data.attributes.total_likes;
                if (infoState === 0) viewVal.textContent = v;
            } catch (err) {
                v = "1";
                if (infoState === 0) viewVal.textContent = v;
            }
        }
        fetchGlobalViews();

        async function updateInfoDisplay() {
            if (infoState === 0) { viewVal.textContent = v; viewLabel.textContent = "Vues"; }
            else if (infoState === 1) { 
                let bat = "N/A"; 
                if (navigator.getBattery) { 
                    const b = await navigator.getBattery(); 
                    bat = Math.round(b.level * 100) + "%"; 
                }
                viewVal.textContent = bat; viewLabel.textContent = "BATTERIE"; 
            }
            else if (infoState === 2) { viewVal.textContent = navigator.platform.substring(0,8).toUpperCase(); viewLabel.textContent = "SYSTEME"; }
            else if (infoState === 3) { viewVal.textContent = `${window.screen.width}X${window.screen.height}`; viewLabel.textContent = "RESOLUTION"; }
        }
        
        document.getElementById('view-widget').onclick = () => { playTick(); infoState = (infoState + 1) % 4; updateInfoDisplay(); };

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playTick() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
            o.frequency.setValueAtTime(180, audioCtx.currentTime);
            g.gain.setValueAtTime(0.02, audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.04);
            o.connect(g); g.connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime + 0.04);
        }

        const cursor = document.getElementById('cursor-dot');
        const title = document.getElementById('main-title');
        let mouse = { x: -1000, y: -1000 };

        window.addEventListener('mousemove', e => {
            mouse.x = e.clientX; mouse.y = e.clientY;
            cursor.style.left = `${e.clientX}px`; cursor.style.top = `${e.clientY}px`;
            const r = title.getBoundingClientRect();
            title.style.setProperty('--m-x', `${e.clientX - r.left}px`);
            title.style.setProperty('--m-y', `${e.clientY - r.top}px`);
            document.querySelectorAll('.active-fx').forEach(el => {
                const b = el.getBoundingClientRect();
                if (e.clientX > b.left && e.clientX < b.right && e.clientY > b.top && e.clientY < b.bottom) {
                    const tx = (e.clientX - (b.left + b.width/2)) / 12;
                    const ty = (e.clientY - (b.top + b.height/2)) / 6;
                    el.style.transform = `scale(1.01) translate(${tx}px, ${ty}px) skewX(${tx/2}deg)`;
                } else { el.style.transform = `scale(1) translate(0, 0) skewX(0)`; }
            });
        });

        window.onmousedown = () => cursor.classList.add('hover');
        window.onmouseup = () => cursor.classList.remove('hover');
        document.querySelectorAll('.active-fx').forEach(el => {
            el.onmouseenter = () => { cursor.classList.add('hover'); playTick(); el.dataset.hovered = "true"; };
            el.onmouseleave = () => { cursor.classList.remove('hover'); el.dataset.hovered = "false"; };
        });
        document.getElementById('about-trigger').onclick = function() { this.classList.toggle('open'); playTick(); };

        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        function init() {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            particles = [];
            for (let x = 12; x < canvas.width; x += 24) {
                for (let y = 12; y < canvas.height; y += 24) { particles.push({ x, y, bx: x, by: y }); }
            }
        }
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const isLight = body.classList.contains('light-mode');
            const colorMain = isLight ? "rgba(0,0,0,0.8)" : "rgba(255,255,255,0.8)";
            const colorInv = isLight ? "rgba(255,255,255,0.8)" : "rgba(0,0,0,0.8)";
            particles.forEach(p => {
                let dx = mouse.x - p.x; let dy = mouse.y - p.y; let d = Math.sqrt(dx*dx + dy*dy);
                if (d < 70) { p.x -= dx/d * (70-d)/5; p.y -= dy/d * (70-d)/5; }
                else { p.x += (p.bx - p.x) * 0.1; p.y += (p.by - p.y) * 0.1; }
                let finalColor = colorMain;
                document.querySelectorAll('.active-fx').forEach(el => {
                    if (el.dataset.hovered === "true") {
                        const r = el.getBoundingClientRect();
                        if (p.x > r.left && p.x < r.right && p.y > r.top && p.y < r.bottom) finalColor = colorInv;
                    }
                });
                ctx.fillStyle = finalColor; ctx.beginPath(); ctx.arc(p.x, p.y, 0.9, 0, 7); ctx.fill();
            });
            requestAnimationFrame(animate);
        }
        window.onresize = init; init(); animate();
        updateRevealColor();
    </script>
</body>
</html>
